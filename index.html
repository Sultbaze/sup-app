<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SUP APP ğŸš€</title>
<style>
body { margin:0; font-family: Arial,sans-serif; background:#111; color:white; text-align:center; }
header { background: gold; color:black; padding:15px; }
header h1 { margin:0; }
nav { background:#222; padding:10px; display:flex; justify-content:center; }
nav a { color:white; margin:0 15px; text-decoration:none; padding:5px 10px; }
nav a.active { border-bottom:2px solid gold; color:gold; }
.tab-content { display:none; padding:20px; }
video { margin:10px; border:2px solid gold; border-radius:8px; }
#chatBox { border:1px solid gold; height:200px; overflow-y:auto; padding:10px; margin:10px auto; width:80%; }
</style>
</head>
<body>

<header>
<h1>ğŸš€ SUP APP</h1>
<p>1-on-1 & Group Calls Â· Audio Â· Video Â· Chat</p>
</header>

<nav>
<a href="#" class="active" onclick="openTab('videoCall', this)">ğŸ“¹ Video</a>
<a href="#" onclick="openTab('audioCall', this)">ğŸ“ Audio</a>
<a href="#" onclick="openTab('chat', this)">ğŸ’¬ Chat</a>
</nav>

<!-- VIDEO CALL -->
<div id="videoCall" class="tab-content" style="display:block;">
<h2>ğŸ“¹ Video Call</h2>
<video id="localVideo" autoplay playsinline muted width="40%"></video>
<video id="remoteVideo" autoplay playsinline width="40%"></video><br>
<button onclick="startCall()">Start Video Call</button>
</div>

<!-- AUDIO CALL -->
<div id="audioCall" class="tab-content">
<h2>ğŸ“ Audio Call</h2>
<button onclick="startAudio()">Start Audio Call</button>
</div>

<!-- CHAT -->
<div id="chat" class="tab-content">
<h2>ğŸ’¬ Chat</h2>
<div id="chatBox"></div>
<input type="text" id="chatInput" placeholder="Type message..." />
<button onclick="sendChat()">Send</button>
</div>

<!-- BACKGROUND SELECTOR -->
<div>
<label style="color:gold;">Background:</label>
<select onchange="changeBackground(this.value)">
<option value="black">Black</option>
<option value="beach">ğŸ Beach</option>
<option value="city">ğŸŒ† City</option>
</select>
</div>

<!-- CONTACT PICKER -->
<div>
<button onclick="pickContact()">ğŸ“‡ Pick Contact</button>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();

// --- Tabs ---
function openTab(tabId, el) {
document.querySelectorAll('.tab-content').forEach(c => c.style.display="none");
document.getElementById(tabId).style.display="block";
document.querySelectorAll('nav a').forEach(a => a.classList.remove("active"));
el.classList.add("active");
}

// --- WebRTC ---
let pc = new RTCPeerConnection({
iceServers: [
{ urls: "stun:stun.l.google.com:19302" },
{ urls: "turn:openrelay.metered.ca:80", username: "openrelayproject", credential: "openrelayproject" }
]
});

let localVideo = document.getElementById("localVideo");
let remoteVideo = document.getElementById("remoteVideo");

pc.ontrack = event => { remoteVideo.srcObject = event.streams[0]; };

async function startCall() {
let stream = await navigator.mediaDevices.getUserMedia({ video:true, audio:true });
localVideo.srcObject = stream;
stream.getTracks().forEach(track => pc.addTrack(track, stream));
let offer = await pc.createOffer();
await pc.setLocalDescription(offer);
socket.emit("offer", offer);
}

async function startAudio() {
let stream = await navigator.mediaDevices.getUserMedia({ audio:true });
stream.getTracks().forEach(track => pc.addTrack(track, stream));
let offer = await pc.createOffer();
await pc.setLocalDescription(offer);
socket.emit("offer", offer);
}

socket.on("offer", async offer => {
await pc.setRemoteDescription(new RTCSessionDescription(offer));
let answer = await pc.createAnswer();
await pc.setLocalDescription(answer);
socket.emit("answer", answer);
});

socket.on("answer", answer => pc.setRemoteDescription(new RTCSessionDescription(answer)));
socket.on("ice-candidate", cand => pc.addIceCandidate(new RTCIceCandidate(cand)));
pc.onicecandidate = e => { if (e.candidate) socket.emit("ice-candidate", e.candidate); };

// --- Chat ---
function sendChat() {
const msg = document.getElementById("chatInput").value;
socket.emit("chat", msg);
document.getElementById("chatInput").value="";
}
socket.on("chat", msg => {
document.getElementById("chatBox").innerHTML += `<p>${msg}</p>`;
});

// --- Background ---
function changeBackground(bg) {
if(bg==="beach") document.body.style.backgroundImage="url('beach.jpg')";
else if(bg==="city") document.body.style.backgroundImage="url('city.jpg')";
else { document.body.style.backgroundImage="none"; document.body.style.background=bg; }
}

// --- Contact Picker ---
async function pickContact() {
if ("contacts" in navigator && "ContactsManager" in window) {
const props = ["name", "tel"];
const opts = { multiple: false };
try {
const contacts = await navigator.contacts.select(props, opts);
alert("Picked: " + JSON.stringify(contacts));
} catch (err) { alert("Contact access denied or unsupported"); }
} else {
alert("Contact API not supported on this device");
}
}
</script>
</body>
</html>
	
